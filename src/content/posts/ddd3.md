---
title: "ドメイン駆動設計 モデリング/実践ガイド 備忘録③"
date: 2022-06-12T22:01:28+09:00
draft: true
---

# 第３章 DDD固有のモデリング手法

## 集約

### 集約とは

「必ず守りたい強い整合性を持ったオブジェクトのまとまり」 

例えば、一つの「部」に「部員」が5人以上なら部は「承認済み」、4人以下なら「未承認」だとすると、  
「部」オブジェクトと「部員」オブジェクトは「強い整合性をもったオブジェクトのまとまり」なので集約となる。  

### 設計/実装時のルール

- 強い整合性確保が必要なものを１つの集約にする
  - すべてのオブジェクトはいずれかの集約に属する
  - 集約の親となるオブジェクトを「集約ルート」とする
- トランザクションを一つにする
  - 必ず集約単位でリポジトリから取得し、集約単位でリポジトリへ渡す。

### 集約の境界の決め方

- 整合性を確保する必要性の強さ
- トランザクションの範囲の適切さ
  - 大きすぎるとDBのロックが広がり、問題が起きやすくなる。

## 境界づけられたコンテキスト

システムの規模が大きくなるにつれて、関係者すべてで統一したモデルを作ることが難しい。  
例えば、一つの商品に対しても、販売部と配送部と経理部で必要になる概念が異なるのでので一つのモデルで管理しにくい。  

モデルが適用される範囲を明示的に定義し、そのなかでモデル、言語の統一を目指す。

