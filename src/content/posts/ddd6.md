---
title: "ドメイン駆動設計 モデリング/実践ガイド 備忘録⑥"
date: 2022-07-02T15:49:08+09:00
draft: true
---

# 第6章 ドメイン層の実装

- ドメインオブジェクト
  - エンティティ(もの)
  - 値オブジェクト(もの)
  - ドメインイベント(こと)

エンティティは識別子で識別、値オブジェクトは値で識別。  

- ドメインオブジェクトを使用するもの
  - リポジトリ
  - ファクトリー
  - ドメインサービス

## エンティティ

社員で例えると  

ID: 123  
名前: 山田  
身長: 170cm  

ID: 456  
名前: 山田  
身長: 170cm  

IDが違うので識別される。  

## 値オブジェクト

お金で例えると  

山田さんが  
令和1年の10円玉を持っている状況  
と  
令和2年の10円玉を持っている状況  

所持金としては10円として考えられる。  
つまり、物体自体は違っても同じ価値として見ている。  

また、10円玉が100円玉へ変更されることはないように、  
値オブジェクトは更新されることのない不変なもの。  

## ドメインサービス

オブジェクト自身では表現することができない場合に使用する。  
他のオブジェクトの情報も必要になる場合。  

「手続き的になる->従来のビジネスロジック層」のようになってしまうので、  
極力使わない方が良い。

## リポジトリ

集約単位で永続化層へのアクセスを提供するもの  
集約ルートがリポジトリとやり取りし、集約ルートのエンティティになる。  

子オブジェクトは集約ルートがインスタンス参照した状態で常に扱う。  

### Listとして扱う

リポジトリでは、
「ユーザを新規登録する」ではなく「新規登録状態のユーザを追加する」  
ドメイン知識はドメイン層にすべて寄せる。  

リポジトリにドメイン知識を書かないことによって、テストもしやすくなる。  

なぜなら、データベースへのアクセスをオンメモリでモックできるから。  
